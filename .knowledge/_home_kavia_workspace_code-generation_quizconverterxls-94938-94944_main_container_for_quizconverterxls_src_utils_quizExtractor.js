{"is_source_file": true, "format": "JavaScript", "description": "This file provides utility functions to extract quiz questions, options, and answers from HTML content converted from Word documents, including parsing and preparing data for Excel export.", "external_files": [], "external_methods": ["document.createElement", "document.querySelectorAll"], "published": ["extractQuizData", "prepareExcelData"], "classes": [], "methods": [{"name": "extractQuizData", "description": "Processes HTML content to extract quiz questions, options, and answers, returning an array of quiz items."}, {"name": "splitIntoQuestions", "description": "Splits the HTML content into individual question blocks based on question numbering patterns or paragraph structures."}, {"name": "extractHTMLForTextRange", "description": "Maps text ranges back to corresponding HTML segments within a DOM container."}, {"name": "parseQuestionBlock", "description": "Parses a question block of HTML to extract question text, options, and the correct answer."}, {"name": "createColumnHeaders", "description": "Creates headers for Excel export based on the maximum number of options."}, {"name": "prepareExcelData", "description": "Prepares quiz data into a format suitable for Excel, including headers and rows."}], "calls": ["document.createElement", "document.querySelectorAll", "tempDiv.innerHTML", "tempDiv.textContent", "questionRegex.exec", "extractHTMLForTextRange", "tempDiv.querySelectorAll", "listItems.querySelector", "String.fromCharCode"], "search-terms": ["quizExtractor.js", "extractQuizData", "splitIntoQuestions", "parseQuestionBlock", "prepareExcelData"], "state": 2, "file_id": 18, "knowledge_revision": 48, "git_revision": "6c893ddf872ad8bcde3fecd2b762aad2071c7f20", "revision_history": [{"37": "98781f45bbcf12dbbd5207098e6af940af9134c3"}, {"45": "a896b64589c5eed07139ec8d4f72cd5dbcfed8f0"}, {"46": "a896b64589c5eed07139ec8d4f72cd5dbcfed8f0"}, {"47": "51cd90740abfc458e787aa1640f3fa7ad8a7d018"}, {"48": "6c893ddf872ad8bcde3fecd2b762aad2071c7f20"}], "ctags": [{"_type": "tag", "name": "answer", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let answer = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "answerMatch", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const answerMatch = optionsText.match(\\/(?:answer|correct|solution):?\\\\s*([A-Z])[.)]\\/i) ||$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "createColumnHeaders", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^export const createColumnHeaders = (maxOptions) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "currentQuestion", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    let currentQuestion = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "end", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const end = i < matches.length - 1 ? matches[i + 1].index : textContent.length;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractHTMLForTextRange", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^const extractHTMLForTextRange = (container, startNodeIndex, textToFind) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractQuizData", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^export const extractQuizData = (htmlContent) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "foundStart", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let foundStart = false;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const headers = ['Question'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const headers = createColumnHeaders(maxOptions);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "html", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let html = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "listItems", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const listItems = tempDiv.querySelectorAll('li');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "match", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let match;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "matches", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const matches = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "maxOptions", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const maxOptions = quizData.reduce($/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const node = nodes[i];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "nodes", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const nodes = container.querySelectorAll('*');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "optionLetter", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const optionLetter = String.fromCharCode(65 + i); \\/\\/ Convert 0 to 'A', 1 to 'B', etc.$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "optionMatches", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const optionMatches = optionsText.match(\\/[A-Z][.)]\\\\s*[^\\\\n\\\\r]*([\\\\n\\\\r]|$)\\/g) || [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "options", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const options = optionMatches.map(match => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "optionsText", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const optionsText = textContent.substring(questionEndIndex).trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "para", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^      const para = paragraphs[i].textContent.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "paragraphs", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const paragraphs = tempDiv.querySelectorAll('p');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "parseQuestionBlock", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^const parseQuestionBlock = (questionHtml) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "prepareExcelData", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^export const prepareExcelData = (quizData) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "questionEndIndex", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const questionEndIndex = textContent.indexOf('?') + 1;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "questionHtml", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const questionHtml = extractHTMLForTextRange(tempDiv, textNodesBefore, textOfQuestion);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "questionRegex", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const questionRegex = \\/(?:\\\\n|\\\\r|\\\\r\\\\n)(?:\\\\d+[.):]|[A-Za-z][.):])(?:\\\\s+|$)|(?:\\\\n|\\\\r|\\\\r/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "questionStarted", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    let questionStarted = false;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "questionText", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let questionText = textContent.substring(0, questionEndIndex).trim();$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "questionsHtml", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const questionsHtml = splitIntoQuestions(htmlContent);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const result = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const result = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const rows = quizData.map(item => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "splitIntoQuestions", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^const splitIntoQuestions = (htmlContent) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const start = matches[i].index;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "tempDiv", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const tempDiv = document.createElement('div');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^        const text = listItems[i].textContent.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textBeforeQuestion", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const textBeforeQuestion = textContent.substring(0, start);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textContent", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const textContent = tempDiv.textContent.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textContent", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  const textContent = tempDiv.textContent;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textFound", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^  let textFound = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "textNodesBefore", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const textNodesBefore = textBeforeQuestion.split(\\/\\\\n|\\\\r|\\\\r\\\\n\\/).length;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textOfQuestion", "path": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "pattern": "/^    const textOfQuestion = textContent.substring(start, end);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/quizconverterxls-94938-94944/main_container_for_quizconverterxls/src/utils/quizExtractor.js", "hash": "bf4636f38789ef8caae833fe7b9b16d3", "format-version": 4, "code-base-name": "default", "fields": [{"name": "let answer = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let currentQuestion = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let foundStart = false;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let html = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let match;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let questionStarted = false;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let questionText = textContent.substring(0, questionEndIndex).trim();", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let textFound = '';", "scope": "", "scopeKind": "", "description": "unavailable"}]}